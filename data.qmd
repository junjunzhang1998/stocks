## Data
Our project uses three datasets that draw on two sources of data. The first dataset comes from Box Office Mojo, which reports domestic box office performance based on revenue submitted by studios and theater chains (https://www.boxofficemojo.com/year/?ref_=bo_nb_di_secondarytab). We scraped the site’s annual summary table using pandas.read_html(), which includes total box office, year-over-year percent change, number of releases, and the highest-grossing film for each year. The full scraping workflow is documented in data-raw/movie-boxoffice.ipynb.

The second dataset is made up of stock prices of publicly traded movie-industry companies from the year 2019-01-01 to 2025-11-30. We pulled the data from Yahoo Finance using the yfinance package. Our movie-industry companies include major theater chains (AMC, CNK, IMAX), legacy studios (Disney, Comcast, Paramount/Sky, Warner Bros. Discovery, Fox), streaming platforms (Netflix, Roku), and diversified media (SONY). We also added the S&P 500 index for benchmarking. Yahoo Finance provides daily open, high, low, close, adjusted close, and volume data, which we used to compute returns, volatility, and drawdowns. The full code for downloading and transforming this dataset is in data-raw/movie-stocks.ipynb.

The third dataset extends the financial view by pulling data on a few broad sector ETFs from Yahoo Finance, allowing us to compare movie-industry companies to the overall market and other major sectors. This data was also downloaded and cleaned in data-raw/movie-stocks.ipynb.


## Description
All datasets were collected and ran through Jupyter Notebooks stored in the data-raw/ folder. We exported these datasets as cleaned csv in the data folder to ensure reproducibility. The main limitations are that Box Office Mojo occasionally changes its HTML structure, and Yahoo Finance’s API can return missing values, but both sources are widely used and generally reliable for exploratory analysis. 


## Missing value analysis
The movie/media prices dataset has almost complete data. The only thing missing is the extra features created, and only about 2% of rows are missing vol_21d, and a smaller share (around 0.2%) is missing return. For the columns with missing values, such as the Volume or Close, the missingness plot shows that these mostly show up together. This implies that for a handful of dates, the whole price record is absent. 

For the sector ETF data, the story is very similar. All of the core price and identifier columns are complete, and the only missing values show up in vol_21d and a few return entries. So during the analysis and graphing, it’s reasonable to either drop these rows.

For the box-office table, there are no missing values at all.


### Missing Value Analysis

Describe any patterns you discover in missing values. If no values are missing, graphs should still be included showing that.

(suggested: 2 graphs plus commentary)

```{r fig.width = 9, fig.height = 4}
#load the three datasets and tidyverse package
library(tidyverse)


### --- Load & clean Media data ---
media <- read_csv("data/movie_media_clean.csv", show_col_types = FALSE) |>
  mutate(Date = as.Date(Date))

# --- Load & clean Sector ETFs ---
sectors <- read_csv("data/sector_etfs_clean.csv", show_col_types = FALSE) |>
  mutate(Date = as.Date(Date))

# --- Load Box Office Data ---
box_office <- read_csv("data/box_office.csv", show_col_types = FALSE)
# use mutate(Date = ...) here only if box_office contains a date column

library(redav)

p_media   <- plot_missing(media,   num_char = 4)
p_sectors <- plot_missing(sectors, num_char = 4)
p_box     <- plot_missing(box_office, num_char = 4)

p_media
p_sectors
p_box
```


```{r}
library(tidyverse)
library(scales)

# sectors
missing_summary_sectors <- sectors |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

# media
missing_summary_media <- media |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

# box office
missing_summary_box <- box_office |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")
```


```{r}
library(tidyverse)
library(scales)

# example: sectors data (do the same for media, box_office)
missing_summary_sectors <- sectors |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

ggplot(missing_summary_sectors,
       aes(x = fct_reorder(variable, prop_missing),
           y = prop_missing)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  scale_y_continuous(
  labels = percent_format(accuracy = 0.1),
  breaks = c(0, 0.0025, 0.005, 0.0075, 0.01)  # adjust as you like
) +
  labs(
    title = "Percent of Missing Values by Variable (Sector ETFs)",
    x = "",
    y = "% of rows missing"
  ) +
  theme_minimal(base_size = 12)
```


```{r}
library(ggplot2)
library(forcats)
library(scales)

## Movie/media missingness
ggplot(missing_summary_media,
       aes(x = fct_reorder(variable, prop_missing),
           y = prop_missing)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  scale_y_continuous(
  labels = percent_format(accuracy = 0.1),
  breaks = c(0, 0.0025, 0.005, 0.0075, 0.01)  # adjust as you like
) +
  labs(
    title = "Percent of Missing Values by Variable (Movie/Media)",
    x = "",
    y = "% of rows missing"
  ) +
  theme_minimal(base_size = 12)
```


