## Data

## Description
The first dataset comes from [Box Office Mojo](https://www.boxofficemojo.com/year/?ref_=bo_nb_di_secondarytab), which reports annual domestic box office revenue and number of releases submitted by studios and theaters. Our full scraping workflow is documented in data-raw/movie-boxoffice.ipynb. The table is updated once per year and contains roughly one row per available year from 2015- 2025 (10 rows x 6 columns).

The second dataset is made up of stock prices of publicly traded movie-industry companies from the year 2019-01-01 to 2025-11-30. We pulled the data from Yahoo Finance using the yfinance package. We selected movie-industry companies including major theater chains (AMC, CNK, IMAX), legacy studios (Disney, Comcast, Paramount/Sky, Warner Bros. Discovery, Fox), streaming platforms (Netflix, Roku), and diversified media (SONY). We also added the S&P 500 index for benchmarking. Yahoo Finance provides daily open, high, low, close, adjusted close, and volume data, which we used to compute returns, volatility, and drawdowns. The full code for downloading and transforming this dataset is in data-raw/movie-stocks.ipynb. This dataset has 20856 rows and 13 columns. 

The third dataset pulls data on a few broad sector ETFs from Yahoo Finance, allowing us to compare movie-industry companies to the overall market and other major sectors. This data was also downloaded and cleaned in data-raw/movie-stocks.ipynb. Yfinance updates the stock prices each trading day. This dataset has 12166 rows and 13 columns. 

These three datasets were collected and ran through Jupyter Notebooks stored in the /data-raw folder. We exported these datasets as cleaned csv in the data folder to ensure reproducibility. The main limitations are that Box Office Mojo occasionally changes its HTML structure, and Yahoo Finance’s API can return missing values, but both sources are generally reliable. 

A fourth dataset comes from AMC’s “U.S. Markets – Theatres & Screens” tables for 2019 and 2024. We copied these tables from AMC’s 10-K filings on its investor relations site  ([2019 10-K](https://investor.amctheatres.com/sec-filings/all-sec-filings/content/0001411579-20-000027/amc-20191231x10k.htm) and [2024 10-K](https://investor.amctheatres.com/sec-filings/all-sec-filings/content/0001411579-25-000042/amc-20241231x10k.htm)) and manually cleaned them in Excel into two files (AMC_theatres_screens_by_market_2019.xlsx and AMC_theatres_screens_by_market_2024.xlsx). We used these tables to compare AMC’s closure of theatres by state before and after COVID and to build the choropleth map in Section 1. The table has one row per U.S. state and columns for theatre and screen counts; these filings are updated annually.

## Missing value analysis
Across our datasets, missingness is minimal. In the movie/media prices data, nearly all fields are complete; only the engineered features show gaps- about 2% of rows are missing vol_21d, and a smaller share (around 0.2%) are missing return values. For the columns with missing values, such as Volume or Close, the missingness plot indicates that these mostly show up together. This implies that an entire daily price was absent for a small number of dates.

For the sector ETF data, the story is very similar. All of the core price and identifier columns are complete. The only missing values show up in vol_21d and a few return entries. So during the analysis and graphing, it’s reasonable to either drop these rows.

The box-office dataset contains no missing values.

For the AMC “U.S. Markets – Theatres & Screens” tables (2019 and 2024), we initially observed seven states without computed 2019–2024 changes. When we investigated, we learned that four of these states—Vermont, Mississippi, Maine, and Rhode Island—have never had AMC theatres, so they don’t show up in either year’s table. The remaining three states—Delaware, Wyoming, and New Hampshire—each had one AMC theatre in 2019 but none in 2024, so they were omitted from the 2024 file even though they should appear with a value of 0 theatres. We manually added zeros for these states to represent their 2024 counts accurately. After this correction, the missingness plot shows no missing values; the four states with no AMC presence simply do not appear in the underlying 10-K data because AMC does not operate theatres there.

```{r missing-all, fig.show="asis", message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
library(redav)
library(scales)
library(patchwork)   

# --- Load data ---
media <- read_csv("data/movie_media_clean.csv", show_col_types = FALSE) |>
  mutate(Date = as.Date(Date))

sectors <- read_csv("data/sector_etfs_clean.csv", show_col_types = FALSE) |>
  mutate(Date = as.Date(Date))

box_office <- read_csv("data/box_office.csv", show_col_types = FALSE)

amc_2019_raw <- read_excel("data/AMC_theatres_screens_by_market_2019.xlsx")
amc_2024_raw <- read_excel("data/AMC_theatres_screens_by_market_2024.xlsx")

# helper: make a nice missingness plot with centered title ---------------
make_missing_plot <- function(dat, title_text) {
  p <- plot_missing(dat, num_char = 4)

  # remove the internal "Missing Values" panel title
  p_clean <- p & theme(plot.title = element_blank())

  # add a global, centered title
  p_clean + plot_annotation(
    title = title_text,
    theme = theme(
      plot.title = element_text(
        hjust  = 0.5,          # center
        face   = "bold",
        size   = 14,
        margin = margin(b = 6) # little padding under the title
      )
    )
  )
}

# --- Missingness plots -------------------------
make_missing_plot(media,       "Missing Values – Movie/Media Prices")
make_missing_plot(sectors,     "Missing Values – Sector ETF Data")
make_missing_plot(box_office,  "Missing Values – Box Office Data")
make_missing_plot(amc_2019_raw,"Missing Values – AMC Theatres & Screens (2019)")
make_missing_plot(amc_2024_raw,"Missing Values – AMC Theatres & Screens (2024)")
```



```{r}
# sectors
missing_summary_sectors <- sectors |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

# media
missing_summary_media <- media |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

# box office
missing_summary_box <- box_office |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")
```


```{r}
missing_summary_sectors <- sectors |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

ggplot(missing_summary_sectors,
       aes(x = fct_reorder(variable, prop_missing),
           y = prop_missing)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  scale_y_continuous(
  labels = percent_format(accuracy = 0.1),
  breaks = c(0, 0.0025, 0.005, 0.0075, 0.01)  # adjust as you like
) +
  labs(
    title = "Percent of Missing Values by Variable (Sector ETFs)",
    x = "",
    y = "% of rows missing"
  ) +
  theme_minimal(base_size = 12)
```


```{r}
## Movie/media missingness
ggplot(missing_summary_media,
       aes(x = fct_reorder(variable, prop_missing),
           y = prop_missing)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  scale_y_continuous(
  labels = percent_format(accuracy = 0.1),
  breaks = c(0, 0.0025, 0.005, 0.0075, 0.01)  
) +
  labs(
    title = "Percent of Missing Values by Variable (Movie/Media)",
    x = "",
    y = "% of rows missing"
  ) +
  theme_minimal(base_size = 12)
```


