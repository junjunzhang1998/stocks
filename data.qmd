## Data


## Description
Our project uses three datasets that draw on two sources of data. The first dataset comes from Box Office Mojo, which reports domestic box office performance based on revenue submitted by studios and theater chains (https://www.boxofficemojo.com/year/?ref_=bo_nb_di_secondarytab). We scraped the site’s annual summary table using pandas.read_html(), which includes total box office, year-over-year percent change, number of releases, and the highest-grossing film for each year. The full scraping workflow is documented in data-raw/movie-boxoffice.ipynb.

The second dataset is made up of stock prices of publicly traded movie-industry companies from the year 2019-01-01 to 2025-11-30. We pulled the data from Yahoo Finance using the yfinance package. Our movie-industry companies include major theater chains (AMC, CNK, IMAX), legacy studios (Disney, Comcast, Paramount/Sky, Warner Bros. Discovery, Fox), streaming platforms (Netflix, Roku), and diversified media (SONY). We also added the S&P 500 index for benchmarking. Yahoo Finance provides daily open, high, low, close, adjusted close, and volume data, which we used to compute returns, volatility, and drawdowns. The full code for downloading and transforming this dataset is in data-raw/movie-stocks.ipynb.

The third dataset extends the financial view by pulling data on a few broad sector ETFs from Yahoo Finance, allowing us to compare movie-industry companies to the overall market and other major sectors. This data was also downloaded and cleaned in data-raw/movie-stocks.ipynb.

These three datasets were collected and ran through Jupyter Notebooks stored in the data-raw/ folder. We exported these datasets as cleaned csv in the data folder to ensure reproducibility. The main limitations are that Box Office Mojo occasionally changes its HTML structure, and Yahoo Finance’s API can return missing values, but both sources are widely used and generally reliable for exploratory analysis. 

A fourth dataset comes from AMC’s “U.S. Markets – Theatres & Screens” tables for 2019 and 2024. We copied these tables from AMC’s 10-K filings on its investor relations site (https://investor.amctheatres.com/sec-filings/all-sec-filings/content/0001411579-20-000027/amc-20191231x10k.htm and https://investor.amctheatres.com/sec-filings/all-sec-filings/content/0001411579-25-000042/amc-20241231x10k.htm) and manually cleaned them in Excel into two files (AMC_theatres_screens_by_market_2019.xlsx and AMC_theatres_screens_by_market_2024.xlsx). We use these tables to compare AMC’s closure of theatres by state before and after COVID and to build the choropleth map in Section 1.

## Missing value analysis
The movie/media prices dataset has almost complete data. The only thing missing is the extra features created, and only about 2% of rows are missing vol_21d, and a smaller share (around 0.2%) is missing return. For the columns with missing values, such as the Volume or Close, the missingness plot shows that these mostly show up together. This implies that for a handful of dates, the whole price record is absent. 

For the sector ETF data, the story is very similar. All of the core price and identifier columns are complete, and the only missing values show up in vol_21d and a few return entries. So during the analysis and graphing, it’s reasonable to either drop these rows.

For the box-office table, there are no missing values at all.

As for the fourth dataset from AMC’s “U.S. Markets – Theatres & Screens” tables for 2019 and 2024, we manually added data for three states into the 2024 file. When we checked missing values after making the AMC map, we noticed seven states with no 2019–2024 change data. After further looking into them, we found out that four of them (Vermont, Mississippi, Maine, and Rhode Island) never had AMC theatres at all, so they simply never show up in either table. For the other three (Delaware, Wyoming, and New Hampshire), AMC had one theatre in 2019 but none in 2024, so they were missing from the 2024 file even though they should really appear with a value of 0 theatres so that the graph can correctly show the change. As a result, we manually added the value of 0 for these three states (Delaware, Wyoming, and New Hampshire) for the 2024 file. The missing plot blow shows no value missing while four of states (Vermont, Mississippi, Maine, and Rhode Island) is missing is because they just do not exist in the data. 

```{r missing-all, fig.show="asis", message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
library(redav)
library(patchwork)   

# --- Load data ---
media <- read_csv("data/movie_media_clean.csv", show_col_types = FALSE) |>
  mutate(Date = as.Date(Date))

sectors <- read_csv("data/sector_etfs_clean.csv", show_col_types = FALSE) |>
  mutate(Date = as.Date(Date))

box_office <- read_csv("data/box_office.csv", show_col_types = FALSE)

amc_2019_raw <- read_excel("data/AMC_theatres_screens_by_market_2019.xlsx")
amc_2024_raw <- read_excel("data/AMC_theatres_screens_by_market_2024.xlsx")

# helper: make a nice missingness plot with centered title ---------------
make_missing_plot <- function(dat, title_text) {
  p <- plot_missing(dat, num_char = 4)

  # remove the internal "Missing Values" panel title
  p_clean <- p & theme(plot.title = element_blank())

  # add a global, centered title
  p_clean + plot_annotation(
    title = title_text,
    theme = theme(
      plot.title = element_text(
        hjust  = 0.5,          # center
        face   = "bold",
        size   = 14,
        margin = margin(b = 6) # little padding under the title
      )
    )
  )
}

# --- Missingness plots -------------------------
make_missing_plot(media,       "Missing Values – Movie/Media Prices")
make_missing_plot(sectors,     "Missing Values – Sector ETF Data")
make_missing_plot(box_office,  "Missing Values – Box Office Data")
make_missing_plot(amc_2019_raw,"Missing Values – AMC Theatres & Screens (2019)")
make_missing_plot(amc_2024_raw,"Missing Values – AMC Theatres & Screens (2024)")
```



```{r}
# sectors
missing_summary_sectors <- sectors |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

# media
missing_summary_media <- media |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

# box office
missing_summary_box <- box_office |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")
```


```{r}
missing_summary_sectors <- sectors |>
  summarise(across(everything(), ~ mean(is.na(.)))) |>
  pivot_longer(everything(),
               names_to = "variable",
               values_to = "prop_missing")

ggplot(missing_summary_sectors,
       aes(x = fct_reorder(variable, prop_missing),
           y = prop_missing)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  scale_y_continuous(
  labels = percent_format(accuracy = 0.1),
  breaks = c(0, 0.0025, 0.005, 0.0075, 0.01)  # adjust as you like
) +
  labs(
    title = "Percent of Missing Values by Variable (Sector ETFs)",
    x = "",
    y = "% of rows missing"
  ) +
  theme_minimal(base_size = 12)
```


```{r}
## Movie/media missingness
ggplot(missing_summary_media,
       aes(x = fct_reorder(variable, prop_missing),
           y = prop_missing)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  scale_y_continuous(
  labels = percent_format(accuracy = 0.1),
  breaks = c(0, 0.0025, 0.005, 0.0075, 0.01)  # adjust as you like
) +
  labs(
    title = "Percent of Missing Values by Variable (Movie/Media)",
    x = "",
    y = "% of rows missing"
  ) +
  theme_minimal(base_size = 12)
```


