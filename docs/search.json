[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Stocks",
    "section": "",
    "text": "1 Introduction\nWe chose to examine the movie industry because it’s one of the examples of how COVID reshaped a major part of everyday life. Since COVID, theater closures, shifting release strategies, and the rise of streaming all created a period of uncertainty. This uncertainty affected everything from how many movies were released to how well different companies performed.\nIn this project, we explore these changes by looking at both box-office trends and the stock performance of theaters, studios, and streaming platforms, and by comparing the movie industry to other sectors of the market. Our goal is to give readers a sense of how the industry evolved before, during, and after the pandemic, and to highlight the broader forces—technological, cultural, and economic—that continue to influence how audiences watch movies today.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Description\nOur project uses three datasets that draw on two sources of data. The first dataset comes from Box Office Mojo, which reports domestic box office performance based on revenue submitted by studios and theater chains (https://www.boxofficemojo.com/year/?ref_=bo_nb_di_secondarytab). We scraped the site’s annual summary table using pandas.read_html(), which includes total box office, year-over-year percent change, number of releases, and the highest-grossing film for each year. The full scraping workflow is documented in data-raw/movie-boxoffice.ipynb.\nThe second dataset is made up of stock prices of publicly traded movie-industry companies from the year 2019-01-01 to 2025-11-30. We pulled the data from Yahoo Finance using the yfinance package. Our movie-industry companies include major theater chains (AMC, CNK, IMAX), legacy studios (Disney, Comcast, Paramount/Sky, Warner Bros. Discovery, Fox), streaming platforms (Netflix, Roku), and diversified media (SONY). We also added the S&P 500 index for benchmarking. Yahoo Finance provides daily open, high, low, close, adjusted close, and volume data, which we used to compute returns, volatility, and drawdowns. The full code for downloading and transforming this dataset is in data-raw/movie-stocks.ipynb.\nThe third dataset extends the financial view by pulling data on a few broad sector ETFs from Yahoo Finance, allowing us to compare movie-industry companies to the overall market and other major sectors. This data was also downloaded and cleaned in data-raw/movie-stocks.ipynb.\nAll datasets were collected and ran through Jupyter Notebooks stored in the data-raw/ folder. We exported these datasets as cleaned csv in the data folder to ensure reproducibility. The main limitations are that Box Office Mojo occasionally changes its HTML structure, and Yahoo Finance’s API can return missing values, but both sources are widely used and generally reliable for exploratory analysis.\nthings to work on 12/7/25: - think of a few other charts: - alluvial diagram of movies distributed in theaters vs. streaming? - movies released by different distributors - compare netflix revenue to other companies?",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.2 Missing value analysis",
    "text": "2.2 Missing value analysis",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "Code\n#load the three datasets and tidyverse package\nlibrary(tidyverse)\n\n### --- Load & clean Media data ---\nmedia &lt;- read_csv(\"data/movie_media_clean.csv\", show_col_types = FALSE) |&gt;\n  mutate(Date = as.Date(Date))\n\n# --- Load & clean Sector ETFs ---\nsectors &lt;- read_csv(\"data/sector_etfs_clean.csv\", show_col_types = FALSE) |&gt;\n  mutate(Date = as.Date(Date))\n\n# --- Load Box Office Data ---\nbox_office &lt;- read_csv(\"data/box_office.csv\", show_col_types = FALSE)\n# use mutate(Date = ...) here only if box_office contains a date column\n\n\n\n3.0.1 1. The number of theatre releases and box office revenue still fall flat compared to pre-COVID levels\n\n\nCode\np_box1 &lt;- ggplot(box_office, aes(Year, Domestic_BoxOffice)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 2) +\n  scale_y_continuous(labels = scales::dollar) +\n  labs(\n    title = \"U.S. Theatrical Box Office Revenue by Year\",\n    subtitle = \"Pre-COVID peak, COVID collapse, and incomplete recovery\",\n    x = \"Year\",\n    y = \"Total Domestic Box Office\"\n  ) +\n  theme_minimal()\n\np_box1\n\n\n\n\n\n\n\n\n\n\n\nCode\np_box2 &lt;- ggplot(box_office, aes(Year, Releases)) +\n  geom_col(fill = \"#4C72B0\") +\n  labs(\n    title = \"Number of Theatrical Releases per Year\",\n    subtitle = \"Industry output collapsed during COVID and remains structurally lower\",\n    x = \"Year\",\n    y = \"Number of releases\"\n  ) +\n  theme_minimal()\n\np_box2\n\n\n\n\n\n\n\n\n\nlocations of movie theatres by state? 2019 and then 2024? can count numbers and use map for % of decrease? https://investor.amctheatres.com/sec-filings/all-sec-filings/content/0001411579-25-000042/amc-20241231x10k.htm https://investor.amctheatres.com/sec-filings/all-sec-filings/content/0001411579-20-000027/amc-20191231x10k.htm\n\n\nCode\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(sf)\nlibrary(ggplot2)\nlibrary(scales)\n\n## 1. Read AMC tables -------------------------------------------------------\n\namc_2019 &lt;- read_excel(\n  \"data/AMC_theatres_screens_by_market_2019.xlsx\",\n  sheet = 1\n) |&gt;\n  rename(\n    state    = `U.S. Markets`,\n    theatres = Theatres,\n    screens  = Screens\n  ) |&gt;\n  mutate(state = str_trim(state))\n\namc_2024 &lt;- read_excel(\n  \"data/AMC_theatres_screens_by_market_2024.xlsx\",\n  sheet = 1\n) |&gt;\n  rename(\n    state    = `U.S. Markets`,\n    theatres = Theatres,\n    screens  = Screens\n  ) |&gt;\n  mutate(state = str_trim(state))\n\n## 2. Read shapefile + keep only contiguous U.S. ---------------------------\n\nstates_sf &lt;- st_read(\"data/cb_2018_us_state_20m/cb_2018_us_state_20m.shp\")\n\n\nReading layer `cb_2018_us_state_20m' from data source \n  `/Users/twylazhang/Desktop/Columbia DS/2025Fall/STATGR5702_EDA/Final Project/stocks/data/cb_2018_us_state_20m/cb_2018_us_state_20m.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 52 features and 9 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -179.1743 ymin: 17.91377 xmax: 179.7739 ymax: 71.35256\nGeodetic CRS:  NAD83\n\n\nCode\nstates_sf_conus &lt;- states_sf |&gt;\n  filter(!STUSPS %in% c(\"AK\", \"HI\", \"PR\", \"GU\", \"VI\", \"AS\", \"MP\")) |&gt;\n  mutate(state = NAME)\n\n# vector of valid state names (lower 48 + DC)\nvalid_states &lt;- states_sf_conus$state\n\n## 3. Filter AMC tables to states in shapefile -----------------------------\n\namc_2019_clean &lt;- amc_2019 |&gt;\n  filter(state %in% valid_states)\n\namc_2024_clean &lt;- amc_2024 |&gt;\n  filter(state %in% valid_states)\n\n## 4. Compute changes ------------------------------------------------------\n\nstate_changes &lt;- amc_2019_clean |&gt;\n  select(\n    state,\n    theatres_2019 = theatres,\n    screens_2019  = screens\n  ) |&gt;\n  inner_join(\n    amc_2024_clean |&gt;\n      select(\n        state,\n        theatres_2024 = theatres,\n        screens_2024  = screens\n      ),\n    by = \"state\"\n  ) |&gt;\n  mutate(\n    theatres_change     = theatres_2024 - theatres_2019,\n    theatres_pct_change = (theatres_2024 - theatres_2019) / theatres_2019,\n    screens_change      = screens_2024 - screens_2019,\n    screens_pct_change  = (screens_2024 - screens_2019) / screens_2019\n  )\n\n## 5. Join back to shapefile for mapping -----------------------------------\n\nmap_data &lt;- states_sf_conus |&gt;\n  left_join(state_changes, by = \"state\")\n\n\n\n\nCode\nlibrary(ggplot2)\nlibrary(scales)\n\nggplot(map_data) +\n  geom_sf(aes(fill = theatres_pct_change),\n          color = \"white\", size = 0.2) +\n  # zoom to lower 48 + DC\n  coord_sf(xlim = c(-125, -66), ylim = c(24, 50), expand = FALSE) +\n  scale_fill_gradient2(\n    name   = \"Percent change\\nin theatres\",\n    labels = percent_format(accuracy = 1),\n    low    = \"#b2182b\",   # more negative (closures)\n    mid    = \"white\",\n    high   = \"#2166ac\",   # more positive (growth)\n    midpoint = 0\n  ) +\n  labs(\n    title    = \"Change in AMC Theatres by State (2019–2024)\",\n    subtitle = \"Percent change in number of theatres\",\n    caption  = \"Source: AMC U.S. Markets Theatres & Screens tables, 2019 vs 2024\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.title = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\nCode\nggplot(map_data) +\n  geom_sf(aes(fill = screens_pct_change),\n          color = \"white\", size = 0.2) +\n  coord_sf(xlim = c(-125, -66), ylim = c(24, 50), expand = FALSE) +\n  scale_fill_gradient2(\n    name   = \"Percent change\\nin screens\",\n    labels = percent_format(accuracy = 1),\n    low    = \"#b2182b\",   # big decreases\n    mid    = \"white\",\n    high   = \"#2166ac\",   # increases\n    midpoint = 0\n  ) +\n  labs(\n    title    = \"Change in AMC Screens by State (2019–2024)\",\n    subtitle = \"Percent change in number of screens\",\n    caption  = \"Source: AMC U.S. Markets Theatres & Screens tables, 2019 vs 2024\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.title = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\n3.0.2 2. While most U.S. sectors recovered strongly post-COVID, the movie industry lags all major sectors\n\n\nCode\n# Rebase each media company to 1\nmedia_rebased &lt;- media |&gt;\n  group_by(Ticker) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(base = first(Adj_Close),\n         rebased = Adj_Close / base) |&gt;\n  ungroup()\n\n# Compute equal-weight average index\nmovie_index &lt;- media_rebased |&gt;\n  group_by(Date) |&gt;\n  summarize(\n    Movie_Index = mean(rebased, na.rm = TRUE)\n  )\n\n\nsectors_rebased &lt;- sectors |&gt;\n  group_by(Ticker, Sector) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    base = first(`Adj Close`),\n    rebased = `Adj Close` / base\n  ) |&gt;\n  ungroup()\n\n\n# Sector ETF index\nsector_index &lt;- sectors_rebased |&gt;\n  select(Date, Sector, rebased)\n\n# Movie Index needs a pseudo \"Sector\" label\nmovie_index2 &lt;- movie_index |&gt;\n  mutate(Sector = \"Movie Industry\")\n\ncombined &lt;- bind_rows(\n  sector_index,\n  movie_index2 |&gt; mutate(rebased = Movie_Index)\n)\n\n\n\n\nCode\ncombined2 &lt;- combined |&gt;\n  mutate(\n    is_movie = (Sector == \"Movie Industry\")\n  )\n\nggplot(combined2, aes(Date, rebased, color = Sector, group = Sector)) +\n  geom_line(aes(linewidth = is_movie, alpha = is_movie)) +\n  scale_y_log10() +\n  scale_linewidth_manual(values = c(\"FALSE\" = 0.6, \"TRUE\" = 2.0)) +\n  scale_alpha_manual(values = c(\"FALSE\" = 0.8, \"TRUE\" = 1.0)) +\n  labs(\n    title = \"Movie Industry vs Major Sector ETFs (Rebased to 1)\",\n    subtitle = \"Movie Industry highlighted for comparison\",\n    y = \"Rebased Price (log scale)\",\n    x = \"Date\",\n    color = \"Sector / Industry\",\n    linewidth = NULL,\n    alpha = NULL\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"right\")\n\n\n\n\n\n\n\n\n\nUsed average stock price of companies in the movie industry\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(scales)\n\n# combined: Date, Sector, rebased (you already built this)\n# Make sure it's sorted\ncombined2 &lt;- combined |&gt;\n  arrange(Sector, Date)\n\n# 1) Get final rebased value per Sector\nfinal_perf &lt;- combined2 |&gt;\n  group_by(Sector) |&gt;\n  filter(!is.na(rebased)) |&gt;\n  slice_tail(n = 1) |&gt;\n  ungroup() |&gt;\n  transmute(\n    Sector,\n    start = 1,               # everyone starts at 1\n    end   = rebased          # ending multiple\n  )\n\n# Long format for slopegraph\nperf_long &lt;- final_perf |&gt;\n  pivot_longer(\n    cols = c(start, end),\n    names_to  = \"Point\",\n    values_to = \"value\"\n  ) |&gt;\n  mutate(\n    Point = factor(Point, levels = c(\"start\", \"end\")),\n    is_movie = (Sector == \"Movie Industry\")\n  )\n\nggplot(perf_long, aes(x = Point, y = value, group = Sector, color = Sector)) +\n  # connecting line\n  geom_line(aes(linewidth = is_movie, alpha = is_movie)) +\n  # start/end points\n  geom_point(size = 3, aes(size = is_movie)) +\n  # label end with “×1.2”, “×2.3”, etc.\n  geom_text(\n    data = perf_long |&gt; filter(Point == \"end\"),\n    aes(\n      label = paste0(\"×\", round(value, 1)),\n      hjust = -0.1\n    ),\n    size = 3\n  ) +\n  scale_x_discrete(\n    labels = c(\n      start = \"2019 (rebased = 1)\",\n      end   = \"2025 (final level)\"\n    )\n  ) +\n  scale_y_log10(labels = number_format(accuracy = 0.1)) +\n  scale_linewidth_manual(values = c(\"FALSE\" = 0.5, \"TRUE\" = 1.8)) +\n  scale_alpha_manual(values = c(\"FALSE\" = 0.5, \"TRUE\" = 1.0)) +\n  scale_size_manual(values = c(\"FALSE\" = 1.5, \"TRUE\" = 3.5), guide = \"none\") +\n  coord_cartesian(clip = \"off\") +\n  labs(\n    title = \"Growth Since 2019: Movie Industry vs Major Sectors\",\n    subtitle = \"All sectors start at 1; end point shows final multiple (log scale)\",\n    x = \"\",\n    y = \"Rebased level (× starting value)\",\n    color = \"Sector / Industry\",\n    linewidth = NULL,\n    alpha = NULL\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"right\",\n    plot.margin = margin(5.5, 40, 5.5, 5.5) # space for labels on right\n  )\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(scales)\n\n# 1) Get final rebased level for each Sector\nfinal_perf &lt;- combined |&gt;\n  arrange(Sector, Date) |&gt;\n  group_by(Sector) |&gt;\n  filter(!is.na(rebased)) |&gt;\n  slice_tail(n = 1) |&gt;\n  ungroup() |&gt;\n  transmute(\n    Sector,\n    multiple = rebased   # how many times the 2019 starting value\n  ) |&gt;\n  mutate(\n    Sector = fct_reorder(Sector, multiple),\n    is_movie = (Sector == \"Movie Industry\"),\n    label = paste0(\"×\", round(multiple, 1))\n  )\n\nggplot(final_perf, aes(x = Sector, y = multiple, fill = is_movie)) +\n  geom_col() +\n  geom_text(\n    aes(label = label),\n    hjust = -0.1,\n    size = 3\n  ) +\n  coord_flip(clip = \"off\") +\n  scale_fill_manual(\n    values = c(\"FALSE\" = \"grey70\", \"TRUE\" = \"#d73027\"),\n    guide = \"none\"\n  ) +\n  scale_y_continuous(\n    expand = expansion(mult = c(0, 0.15))\n  ) +\n  labs(\n    title = \"Cumulative Performance Since 2019\",\n    subtitle = \"Each bar shows final rebased level (2019 = 1)\",\n    x = \"\",\n    y = \"Rebased level (× starting value)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.margin = margin(5.5, 40, 5.5, 5.5)\n  )\n\n\n\n\n\n\n\n\n\n\n\n3.0.3 3. Performance of sub-industries within the movie industry differ\n\n\nCode\nmedia_rebased &lt;- media |&gt;\n  group_by(Ticker) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    base = first(Adj_Close),\n    rebased = Adj_Close / base\n  ) |&gt;\n  ungroup()\n\nggplot(media_rebased, aes(Date, rebased, color = Ticker)) +\n  geom_line(alpha = 0.85) +\n  scale_y_log10() +\n  labs(\n    title = \"Long-Term Performance of Movie/Media Companies vs S&P 500\",\n    subtitle = \"Rebased to 1 at first date; log scale highlights relative divergence\",\n    y = \"Rebased Price (log scale)\",\n    x = \"Date\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nmedia_rebased &lt;- media |&gt;\n  filter(!is.na(Adj_Close)) |&gt;\n  group_by(Ticker, SubIndustry) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    base    = first(Adj_Close),\n    rebased = Adj_Close / base\n  ) |&gt;\n  ungroup()\n\np2 &lt;- ggplot(media_rebased, aes(Date, rebased, color = Ticker)) +\n  geom_line(alpha = 0.85) +\n  facet_wrap(~ SubIndustry, scales = \"free_y\") +\n  labs(\n    title = \"Sub-Industry Performance: Theaters vs Studios vs Streamers vs Diversified vs Benchmark\",\n    subtitle = \"Each ticker rebased to 1 at its first non-missing price (log scale)\",\n    y = \"Rebased Price\",\n    x = \"Date\"\n  ) +\n  theme_minimal()\n\nprint(p2)\n\n\n\n\n\n\n\n\n\n\n\nCode\n# -------------------------\n# Rebase individual stocks\n# -------------------------\nmedia_rebased &lt;- media |&gt;\n  filter(!is.na(Adj_Close)) |&gt;\n  group_by(Ticker) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    base = first(Adj_Close),\n    rebased = Adj_Close / base\n  ) |&gt; \n  ungroup()\n\n# -------------------------\n# Equal-weight subindustry index\n# -------------------------\nsubindustry_index &lt;- media_rebased |&gt;\n  group_by(Date, SubIndustry) |&gt;\n  summarize(SubIndex = mean(rebased, na.rm = TRUE), .groups = \"drop\")\n\n# -------------------------\n# Wide matrix\n# -------------------------\nsub_wide &lt;- subindustry_index |&gt;\n  pivot_wider(names_from = SubIndustry, values_from = SubIndex)\n\n# -------------------------\n# Desired order\n# -------------------------\norder_vec &lt;- c(\"Benchmark\", \"Streamer\", \"Diversified\", \"Studio\", \"Theater\")\n\n# -------------------------\n# Correlation matrix with reordered columns\n# -------------------------\ncor_mat &lt;- sub_wide |&gt;\n  select(all_of(order_vec)) |&gt;\n  cor(use = \"pairwise.complete.obs\")\n\n# -------------------------\n# Tidy long format\n# -------------------------\ncor_long &lt;- cor_mat |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(\"Var1\") |&gt;\n  pivot_longer(cols = order_vec, names_to = \"Var2\", values_to = \"Correlation\")\n\n# -------------------------\n# Plot heatmap\n# -------------------------\nggplot(cor_long, aes(Var1, Var2, fill = Correlation)) +\n  geom_tile(color = \"white\", linewidth = 0.3) +\n  scale_fill_viridis_c(option = \"C\", limits = c(-1, 1)) +\n  labs(\n    title = \"Correlation Between Movie/Media Sub-Industries (2015–2025)\",\n    subtitle = \"Clearer block structure after business-driven ordering\",\n    x = \"\", y = \"\", fill = \"Correlation\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\nCode\n# 1) Equal-weight subindustry index (rebased)\nsub_index &lt;- media |&gt;\n  filter(!is.na(Adj_Close)) |&gt;\n  group_by(Ticker) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    base = first(Adj_Close),\n    rebased = Adj_Close / base\n  ) |&gt;\n  ungroup() |&gt;\n  group_by(Date, SubIndustry) |&gt;\n  summarize(\n    SubIndex = mean(rebased, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# 2) Drawdown per subindustry\nsub_dd &lt;- sub_index |&gt;\n  group_by(SubIndustry) |&gt;\n  arrange(Date, .by_group = TRUE) |&gt;\n  mutate(\n    roll_max = cummax(SubIndex),\n    drawdown = SubIndex / roll_max - 1\n  ) |&gt;\n  ungroup()\n\nggplot(sub_dd, aes(Date, drawdown, color = SubIndustry)) +\n  geom_hline(yintercept = 0, linetype = \"dashed\", linewidth = 0.4) +\n  geom_line(linewidth = 1) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    title = \"Sub-Industry Drawdowns from Prior Peak\",\n    subtitle = \"Theaters suffer persistent deep drawdowns; streamers and diversified recover more\",\n    x = \"Date\",\n    y = \"Drawdown from previous peak\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\ntime_underwater &lt;- sub_dd |&gt;\n  mutate(underwater = drawdown &lt; 0) |&gt;\n  group_by(SubIndustry) |&gt;\n  summarize(\n    pct_underwater = mean(underwater, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\nggplot(time_underwater, aes(fct_reorder(SubIndustry, pct_underwater), pct_underwater)) +\n  geom_col() +\n  coord_flip() +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    title = \"Percent of Days Spent Below Previous Peak\",\n    subtitle = \"Structural damage is largest in Theaters; Benchmark and Diversified fare best\",\n    x = \"\",\n    y = \"% of trading days underwater\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\n# --- Equal-weight subindustry returns (wide) ---\nsub_returns &lt;- media |&gt;\n  filter(!is.na(return)) |&gt;\n  group_by(Date, SubIndustry) |&gt;\n  summarize(sub_ret = mean(return, na.rm = TRUE), .groups = \"drop\") |&gt;\n  pivot_wider(names_from = SubIndustry, values_from = sub_ret) |&gt;\n  drop_na()\n\n# --- PCA matrix ---\nX &lt;- sub_returns |&gt;\n  select(-Date) |&gt;\n  as.matrix()\n\n# --- PCA ---\npca &lt;- prcomp(X, scale. = TRUE)\n\n# --- Loadings (important part) ---\nloadings &lt;- as.data.frame(pca$rotation) |&gt;\n  rownames_to_column(\"SubIndustry\")\n\n# scale arrows for plotting aesthetics\narrow_scale &lt;- 6\nloadings_plot &lt;- loadings |&gt;\n  mutate(\n    PC1 = PC1 * arrow_scale,\n    PC2 = PC2 * arrow_scale\n  )\n\n# --- Clean biplot with arrows only ---\nggplot(loadings_plot, aes(PC1, PC2)) +\n  geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),\n               arrow = arrow(length = unit(0.25, \"cm\")),\n               linewidth = 1,\n               color = \"red\") +\n  geom_text(aes(label = SubIndustry),\n            vjust = -0.5, hjust = 0.5, size = 5, fontface = \"bold\") +\n  labs(\n    title = \"PCA of Movie/Media Subindustry Daily Returns\",\n    subtitle = \"Arrows show subindustry loadings on PC1 and PC2\",\n    x = paste0(\"PC1 (\", round(summary(pca)$importance[2,1]*100,1), \"% variance)\"),\n    y = paste0(\"PC2 (\", round(summary(pca)$importance[2,2]*100,1), \"% variance)\")\n  ) +\n  theme_minimal(base_size = 14)\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(ggridges)\n\n# 2. Build subindustry daily returns (this defines sub_daily) ----\nsub_daily &lt;- media |&gt;\n  filter(!is.na(return)) |&gt;\n  group_by(Date, SubIndustry) |&gt;\n  summarize(\n    sub_ret = mean(return, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# 3. Ridgeline plot, zoomed around typical moves (e.g. -8% to +8%) ----\nggplot(sub_daily, aes(x = sub_ret, y = SubIndustry, fill = SubIndustry)) +\n  geom_density_ridges(alpha = 0.8, scale = 4) +\n  scale_x_continuous(\n    labels = scales::percent,\n    limits = c(-0.08, 0.08)   # zoom in: change to c(-0.05, 0.05) if you want tighter\n  ) +\n  labs(\n    title = \"Density of Daily Returns by Subindustry\",\n    subtitle = \"Zoomed in on typical daily moves (±8%)\",\n    x = \"Daily Return\",\n    y = \"\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\n\n\n3.0.4 4. Netflix behaves like a tech company & AMC theatre underperforms\n\n\nCode\n# 1) Movie industry equal-weight price index (use Adj_Close, not rebased)\nmovie_index &lt;- media |&gt;\n  filter(SubIndustry != \"Benchmark\") |&gt;\n  group_by(Date) |&gt;\n  summarize(\n    movie_price = mean(Adj_Close, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# 2) S&P 500\nsp &lt;- media |&gt;\n  filter(Ticker == \"^GSPC\") |&gt;\n  select(Date, sp_price = Adj_Close)\n\n# 3) Netflix\nnflx &lt;- media |&gt;\n  filter(Ticker == \"NFLX\") |&gt;\n  select(Date, nflx_price = Adj_Close)\n\n# 4) Align dates and rebase all three to 1 at common start\nall3 &lt;- movie_index |&gt;\n  inner_join(sp, by = \"Date\") |&gt;\n  inner_join(nflx, by = \"Date\") |&gt;\n  arrange(Date)\n\nbase_movie &lt;- first(all3$movie_price)\nbase_sp    &lt;- first(all3$sp_price)\nbase_nflx  &lt;- first(all3$nflx_price)\n\nrelative_long &lt;- all3 |&gt;\n  mutate(\n    `Movie Industry` = movie_price / base_movie,\n    `S&P 500`        = sp_price    / base_sp,\n    `Netflix`        = nflx_price  / base_nflx\n  ) |&gt;\n  select(Date, `Movie Industry`, `S&P 500`, `Netflix`) |&gt;\n  pivot_longer(\n    cols = -Date,\n    names_to = \"Series\",\n    values_to = \"rebased\"\n  )\n\nggplot(relative_long, aes(Date, rebased, color = Series)) +\n  geom_line(linewidth = 1) +\n  scale_y_log10() +\n  labs(\n    title = \"Netflix vs Movie Industry vs S&P 500 (Rebased)\",\n    subtitle = \"Netflix tracks the broad market more closely than the struggling movie industry\",\n    x = \"Date\",\n    y = \"Rebased Price (log scale)\",\n    color = \"\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nalluvial diagram of movies distributed in theaters vs. streaming? compare netflix revenue to other companies?",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  }
]